<!-- frontend bootstrap placeholder -->
 <!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <title>CRUD FastAPI + Bootstrap</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

    <style>
        body { background: #f5f6fa; }
        .section-box {
            background: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 2px 6px rgba(0,0,0,0.1);
            margin-bottom: 40px;
        }
    </style>
</head>
<body class="container py-5">

<h1 class="text-center mb-5">Frontend CRUD con FastAPI + Bootstrap</h1>

<!-- ================================= -->
<!--          ESTUDIANTES              -->
<!-- ================================= -->
<div class="section-box">
    <h3 class="mb-3 text-primary">Estudiantes</h3>

    <div class="row g-3">
        <div class="col-md-4">
            <input type="text" id="est-nombre" class="form-control" placeholder="Nombre">
        </div>
        <div class="col-md-2">
            <input type="number" id="est-edad" class="form-control" placeholder="Edad">
        </div>
        <div class="col-md-3">
            <input type="text" id="est-carrera" class="form-control" placeholder="Carrera">
        </div>
        <div class="col-md-3 d-flex gap-2">
            <button class="btn btn-success w-50" onclick="agregarEstudiante()">Agregar</button>
            <button class="btn btn-warning w-50" onclick="actualizarEstudiante()">Actualizar</button>
        </div>
    </div>

    <hr>

    <div class="d-flex justify-content-between mb-3">
        <h5>Listado de Estudiantes</h5>
        <button class="btn btn-primary" onclick="listarEstudiantes()">Actualizar Lista</button>
    </div>

    <table class="table table-bordered table-striped" id="tabla-est">
        <thead class="table-dark">
            <tr>
                <th>ID</th><th>Nombre</th><th>Edad</th><th>Carrera</th><th>Acciones</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>
</div>

<!-- ================================= -->
<!--           PROFESORES              -->
<!-- ================================= -->
<div class="section-box">
    <h3 class="mb-3 text-primary">Profesores</h3>

    <div class="row g-3">
        <div class="col-md-4">
            <input type="text" id="prof-nombre" class="form-control" placeholder="Nombre">
        </div>
        <div class="col-md-2">
            <input type="number" id="prof-edad" class="form-control" placeholder="Edad">
        </div>
        <div class="col-md-3">
            <input type="text" id="prof-materia" class="form-control" placeholder="Materia">
        </div>
        <div class="col-md-3 d-flex gap-2">
            <button class="btn btn-success w-50" onclick="agregarProfesor()">Agregar</button>
            <button class="btn btn-warning w-50" onclick="actualizarProfesor()">Actualizar</button>
        </div>
    </div>

    <hr>

    <div class="d-flex justify-content-between mb-3">
        <h5>Listado de Profesores</h5>
        <button class="btn btn-primary" onclick="listarProfesores()">Actualizar Lista</button>
    </div>

    <table class="table table-bordered table-striped" id="tabla-prof">
        <thead class="table-dark">
            <tr>
                <th>ID</th><th>Nombre</th><th>Edad</th><th>Materia</th><th>Acciones</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>
</div>


<!-- ================================= -->
<!--              CURSOS               -->
<!-- ================================= -->
<div class="section-box">
    <h3 class="mb-3 text-primary">Cursos</h3>

    <div class="row g-3">
        <div class="col-md-6">
            <input type="text" id="cur-titulo" class="form-control" placeholder="Título">
        </div>
        <div class="col-md-3">
            <input type="number" id="cur-creditos" class="form-control" placeholder="Créditos">
        </div>
        <div class="col-md-3 d-flex gap-2">
            <button class="btn btn-success w-50" onclick="agregarCurso()">Agregar</button>
            <button class="btn btn-warning w-50" onclick="actualizarCurso()">Actualizar</button>
        </div>
    </div>

    <hr>

    <div class="d-flex justify-content-between mb-3">
        <h5>Listado de Cursos</h5>
        <button class="btn btn-primary" onclick="listarCursos()">Actualizar Lista</button>
    </div>

    <table class="table table-bordered table-striped" id="tabla-cursos">
        <thead class="table-dark">
            <tr>
                <th>ID</th><th>Título</th><th>Créditos</th><th>Acciones</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>
</div>

<!-- SCRIPTS -->
<script>
const API_URL = "http://127.0.0.1:8000";

/* =============================
      CRUD ESTUDIANTES
============================= */
async function agregarEstudiante() {
    const datos = {
        nombre: document.getElementById("est-nombre").value,
        edad: parseInt(document.getElementById("est-edad").value),
        carrera: document.getElementById("est-carrera").value
    };

    const res = await fetch(`${API_URL}/estudiantes`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(datos)
    });

    alert((await res.json()).mensaje);
    listarEstudiantes();
}

async function listarEstudiantes() {
    const res = await fetch(`${API_URL}/estudiantes`);
    const data = await res.json();

    const tabla = document.querySelector("#tabla-est tbody");
    tabla.innerHTML = "";

    data.forEach(est => {
        tabla.innerHTML += `
            <tr>
                <td>${est.id}</td>
                <td>${est.nombre}</td>
                <td>${est.edad}</td>
                <td>${est.carrera}</td>
                <td>
                    <button class="btn btn-sm btn-success" onclick="cargarEstudiante('${est.nombre}', ${est.edad}, '${est.carrera}')">Editar</button>
                    <button class="btn btn-sm btn-danger" onclick="eliminarEstudiante('${est.nombre}')">Eliminar</button>
                </td>
            </tr>
        `;
    });
}

function cargarEstudiante(nombre, edad, carrera) {
    document.getElementById("est-nombre").value = nombre;
    document.getElementById("est-edad").value = edad;
    document.getElementById("est-carrera").value = carrera;
}

async function actualizarEstudiante() {
    const nombre = document.getElementById("est-nombre").value;
    const datos = {
        nombre,
        edad: parseInt(document.getElementById("est-edad").value),
        carrera: document.getElementById("est-carrera").value
    };

    const res = await fetch(`${API_URL}/estudiantes/${nombre}`, {
        method: "PUT",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(datos)
    });

    alert((await res.json()).mensaje);
    listarEstudiantes();
}

async function eliminarEstudiante(nombre) {
    if (!confirm(`¿Eliminar estudiante ${nombre}?`)) return;

    const res = await fetch(`${API_URL}/estudiantes/${nombre}`, { method: "DELETE" });
    alert((await res.json()).mensaje);
    listarEstudiantes();
}


/* =============================
      CRUD PROFESORES
============================= */
async function agregarProfesor() {
    const datos = {
        nombre: document.getElementById("prof-nombre").value,
        edad: parseInt(document.getElementById("prof-edad").value),
        materia: document.getElementById("prof-materia").value
    };

    const res = await fetch(`${API_URL}/profesores`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(datos)
    });

    alert((await res.json()).mensaje);
    listarProfesores();
}

async function listarProfesores() {
    const res = await fetch(`${API_URL}/profesores`);
    const data = await res.json();

    const tabla = document.querySelector("#tabla-prof tbody");
    tabla.innerHTML = "";

    data.forEach(prof => {
        tabla.innerHTML += `
            <tr>
                <td>${prof.id}</td>
                <td>${prof.nombre}</td>
                <td>${prof.edad}</td>
                <td>${prof.materia}</td>
                <td>
                    <button class="btn btn-sm btn-success" onclick="cargarProfesor('${prof.nombre}', ${prof.edad}, '${prof.materia}')">Editar</button>
                    <button class="btn btn-sm btn-danger" onclick="eliminarProfesor('${prof.nombre}')">Eliminar</button>
                </td>
            </tr>
        `;
    });
}

function cargarProfesor(nombre, edad, materia) {
    document.getElementById("prof-nombre").value = nombre;
    document.getElementById("prof-edad").value = edad;
    document.getElementById("prof-materia").value = materia;
}

async function actualizarProfesor() {
    const nombre = document.getElementById("prof-nombre").value;
    const datos = {
        nombre,
        edad: parseInt(document.getElementById("prof-edad").value),
        materia: document.getElementById("prof-materia").value
    };

    const res = await fetch(`${API_URL}/profesores/${nombre}`, {
        method: "PUT",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(datos)
    });

    alert((await res.json()).mensaje);
    listarProfesores();
}

async function eliminarProfesor(nombre) {
    if (!confirm(`¿Eliminar profesor ${nombre}?`)) return;

    const res = await fetch(`${API_URL}/profesores/${nombre}`, { method: "DELETE" });
    alert((await res.json()).mensaje);
    listarProfesores();
}


/* =============================
          CRUD CURSOS
============================= */
async function agregarCurso() {
    const datos = {
        titulo: document.getElementById("cur-titulo").value,
        creditos: parseInt(document.getElementById("cur-creditos").value)
    };

    const res = await fetch(`${API_URL}/cursos`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(datos)
    });

    alert((await res.json()).mensaje);
    listarCursos();
}

async function listarCursos() {
    const res = await fetch(`${API_URL}/cursos`);
    const data = await res.json();

    const tabla = document.querySelector("#tabla-cursos tbody");
    tabla.innerHTML = "";

    data.forEach(cur => {
        tabla.innerHTML += `
            <tr>
                <td>${cur.id}</td>
                <td>${cur.titulo}</td>
                <td>${cur.creditos}</td>
                <td>
                    <button class="btn btn-sm btn-success" onclick="cargarCurso('${cur.titulo}', ${cur.creditos})">Editar</button>
                    <button class="btn btn-sm btn-danger" onclick="eliminarCurso('${cur.titulo}')">Eliminar</button>
                </td>
            </tr>
        `;
    });
}

function cargarCurso(titulo, creditos) {
    document.getElementById("cur-titulo").value = titulo;
    document.getElementById("cur-creditos").value = creditos;
}

async function actualizarCurso() {
    const titulo = document.getElementById("cur-titulo").value;
    const datos = {
        titulo,
        creditos: parseInt(document.getElementById("cur-creditos").value)
    };

    const res = await fetch(`${API_URL}/cursos/${titulo}`, {
        method: "PUT",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(datos)
    });

    alert((await res.json()).mensaje);
    listarCursos();
}

async function eliminarCurso(titulo) {
    if (!confirm(`¿Eliminar curso ${titulo}?`)) return;

    const res = await fetch(`${API_URL}/cursos/${titulo}`, { method: "DELETE" });
    alert((await res.json()).mensaje);
    listarCursos();
}

// Cargar datos iniciales
listarEstudiantes();
listarCursos();
listarProfesores();
</script>

</body>
</html>
